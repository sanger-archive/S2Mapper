{
  "stage":"batch",
  "steps":[
    {
      "description":"get root",
      "method":     "get",
      "url":        "/",
      "request":    null,
      "response":   {
        "batches":                  {
          "actions":{
            "create":"http://localhost:9292/batches",
            "read":  "http://localhost:9292/batches",
            "first": "http://localhost:9292/batches/page=1",
            "last":  "http://localhost:9292/batches/page=-1"
          }
        },
        "users":                    {
          "actions":{
            "create":"http://localhost:9292/users",
            "read":  "http://localhost:9292/users",
            "first": "http://localhost:9292/users/page=1",
            "last":  "http://localhost:9292/users/page=-1"
          }
        },
        "studies":                  {
          "actions":{
            "create":"http://localhost:9292/studies",
            "read":  "http://localhost:9292/studies",
            "first": "http://localhost:9292/studies/page=1",
            "last":  "http://localhost:9292/studies/page=-1"
          }
        },
        "orders":                   {
          "actions":{
            "create":"http://localhost:9292/orders",
            "read":  "http://localhost:9292/orders",
            "first": "http://localhost:9292/orders/page=1",
            "last":  "http://localhost:9292/orders/page=-1"
          }
        },
        "projects":                 {
          "actions":{
            "create":"http://localhost:9292/projects",
            "read":  "http://localhost:9292/projects",
            "first": "http://localhost:9292/projects/page=1",
            "last":  "http://localhost:9292/projects/page=-1"
          }
        },
        "samples":                  {
          "actions":{
            "create":"http://localhost:9292/samples",
            "read":  "http://localhost:9292/samples",
            "first": "http://localhost:9292/samples/page=1",
            "last":  "http://localhost:9292/samples/page=-1"
          }
        },
        "oligos":                   {
          "actions":{
            "create":"http://localhost:9292/oligos",
            "read":  "http://localhost:9292/oligos",
            "first": "http://localhost:9292/oligos/page=1",
            "last":  "http://localhost:9292/oligos/page=-1"
          }
        },
        "aliquots":                 {
          "actions":{
            "create":"http://localhost:9292/aliquots",
            "read":  "http://localhost:9292/aliquots",
            "first": "http://localhost:9292/aliquots/page=1",
            "last":  "http://localhost:9292/aliquots/page=-1"
          }
        },
        "flowcells":                {
          "actions":{
            "create":"http://localhost:9292/flowcells",
            "read":  "http://localhost:9292/flowcells",
            "first": "http://localhost:9292/flowcells/page=1",
            "last":  "http://localhost:9292/flowcells/page=-1"
          }
        },
        "gels":                     {
          "actions":{
            "create":"http://localhost:9292/gels",
            "read":  "http://localhost:9292/gels",
            "first": "http://localhost:9292/gels/page=1",
            "last":  "http://localhost:9292/gels/page=-1"
          }
        },
        "labellables":              {
          "actions":{
            "create":"http://localhost:9292/labellables",
            "read":  "http://localhost:9292/labellables",
            "first": "http://localhost:9292/labellables/page=1",
            "last":  "http://localhost:9292/labellables/page=-1"
          }
        },
        "sanger_barcodes":          {
          "actions":{
            "create":"http://localhost:9292/sanger_barcodes",
            "read":  "http://localhost:9292/sanger_barcodes",
            "first": "http://localhost:9292/sanger_barcodes/page=1",
            "last":  "http://localhost:9292/sanger_barcodes/page=-1"
          }
        },
        "ean13_barcodes":           {
          "actions":{
            "create":"http://localhost:9292/ean13_barcodes",
            "read":  "http://localhost:9292/ean13_barcodes",
            "first": "http://localhost:9292/ean13_barcodes/page=1",
            "last":  "http://localhost:9292/ean13_barcodes/page=-1"
          }
        },
        "barcode2_ds":              {
          "actions":{
            "create":"http://localhost:9292/barcode2_ds",
            "read":  "http://localhost:9292/barcode2_ds",
            "first": "http://localhost:9292/barcode2_ds/page=1",
            "last":  "http://localhost:9292/barcode2_ds/page=-1"
          }
        },
        "plates":                   {
          "actions":{
            "create":"http://localhost:9292/plates",
            "read":  "http://localhost:9292/plates",
            "first": "http://localhost:9292/plates/page=1",
            "last":  "http://localhost:9292/plates/page=-1"
          }
        },
        "spin_columns":             {
          "actions":{
            "create":"http://localhost:9292/spin_columns",
            "read":  "http://localhost:9292/spin_columns",
            "first": "http://localhost:9292/spin_columns/page=1",
            "last":  "http://localhost:9292/spin_columns/page=-1"
          }
        },
        "tubes":                    {
          "actions":{
            "create":"http://localhost:9292/tubes",
            "read":  "http://localhost:9292/tubes",
            "first": "http://localhost:9292/tubes/page=1",
            "last":  "http://localhost:9292/tubes/page=-1"
          }
        },
        "tube_racks":               {
          "actions":{
            "create":"http://localhost:9292/tube_racks",
            "read":  "http://localhost:9292/tube_racks",
            "first": "http://localhost:9292/tube_racks/page=1",
            "last":  "http://localhost:9292/tube_racks/page=-1"
          }
        },
        "tag_groups":               {
          "actions":{
            "create":"http://localhost:9292/tag_groups",
            "read":  "http://localhost:9292/tag_groups",
            "first": "http://localhost:9292/tag_groups/page=1",
            "last":  "http://localhost:9292/tag_groups/page=-1"
          }
        },
        "searches":                 {
          "actions":{
            "create":"http://localhost:9292/searches",
            "read":  "http://localhost:9292/searches",
            "first": "http://localhost:9292/searches/page=1",
            "last":  "http://localhost:9292/searches/page=-1"
          }
        },
        "multi_criteria_filters":   {
          "actions":{
            "create":"http://localhost:9292/multi_criteria_filters",
            "read":  "http://localhost:9292/multi_criteria_filters",
            "first": "http://localhost:9292/multi_criteria_filters/page=1",
            "last":  "http://localhost:9292/multi_criteria_filters/page=-1"
          }
        },
        "label_filters":            {
          "actions":{
            "create":"http://localhost:9292/label_filters",
            "read":  "http://localhost:9292/label_filters",
            "first": "http://localhost:9292/label_filters/page=1",
            "last":  "http://localhost:9292/label_filters/page=-1"
          }
        },
        "order_filters":            {
          "actions":{
            "create":"http://localhost:9292/order_filters",
            "read":  "http://localhost:9292/order_filters",
            "first": "http://localhost:9292/order_filters/page=1",
            "last":  "http://localhost:9292/order_filters/page=-1"
          }
        },
        "batch_filters":            {
          "actions":{
            "create":"http://localhost:9292/batch_filters",
            "read":  "http://localhost:9292/batch_filters",
            "first": "http://localhost:9292/batch_filters/page=1",
            "last":  "http://localhost:9292/batch_filters/page=-1"
          }
        },
        "uuid_resources":           {
          "actions":{
            "create":"http://localhost:9292/uuid_resources",
            "read":  "http://localhost:9292/uuid_resources",
            "first": "http://localhost:9292/uuid_resources/page=1",
            "last":  "http://localhost:9292/uuid_resources/page=-1"
          }
        },
        "create_batches":           {
          "actions":{
            "create":"http://localhost:9292/actions/create_batch"
          }
        },
        "create_flowcells":         {
          "actions":{
            "create":"http://localhost:9292/actions/create_flowcell"
          }
        },
        "create_gels":              {
          "actions":{
            "create":"http://localhost:9292/actions/create_gel"
          }
        },
        "create_labels":            {
          "actions":{
            "create":"http://localhost:9292/actions/create_label"
          }
        },
        "create_labellables":       {
          "actions":{
            "create":"http://localhost:9292/actions/create_labellable"
          }
        },
        "create_orders":            {
          "actions":{
            "create":"http://localhost:9292/actions/create_order"
          }
        },
        "create_plates":            {
          "actions":{
            "create":"http://localhost:9292/actions/create_plate"
          }
        },
        "create_searches":          {
          "actions":{
            "create":"http://localhost:9292/actions/create_search"
          }
        },
        "create_spin_columns":      {
          "actions":{
            "create":"http://localhost:9292/actions/create_spin_column"
          }
        },
        "create_tubes":             {
          "actions":{
            "create":"http://localhost:9292/actions/create_tube"
          }
        },
        "create_tube_racks":        {
          "actions":{
            "create":"http://localhost:9292/actions/create_tube_rack"
          }
        },
        "plate_transfers":          {
          "actions":{
            "create":"http://localhost:9292/actions/plate_transfer"
          }
        },
        "tag_wells":                {
          "actions":{
            "create":"http://localhost:9292/actions/tag_wells"
          }
        },
        "transfer_plates_to_plates":{
          "actions":{
            "create":"http://localhost:9292/actions/transfer_plates_to_plates"
          }
        },
        "transfer_tubes_to_tubes":  {
          "actions":{
            "create":"http://localhost:9292/actions/transfer_tubes_to_tubes"
          }
        },
        "transfer_wells_to_tubes":  {
          "actions":{
            "create":"http://localhost:9292/actions/transfer_wells_to_tubes"
          }
        },
        "tube_rack_moves":          {
          "actions":{
            "create":"http://localhost:9292/actions/tube_rack_move"
          }
        },
        "tube_rack_transfers":      {
          "actions":{
            "create":"http://localhost:9292/actions/tube_rack_transfer"
          }
        },
        "update_orders":            {
          "actions":{
            "create":"http://localhost:9292/actions/update_order"
          }
        },
        "update_plates":            {
          "actions":{
            "create":"http://localhost:9292/actions/update_plate"
          }
        },
        "update_tubes":             {
          "actions":{
            "create":"http://localhost:9292/actions/update_tube"
          }
        },
        "update_tube_racks":        {
          "actions":{
            "create":"http://localhost:9292/actions/update_tube_rack"
          }
        },
        "revision":                 3
      }
    },
    {
      "description":"Find the tubes by barcodes for tube 1...",
      "method":     "post",
      "url":        "/searches",
      "request":    {
        "search":{
          "user":       "username",
          "description":"search for barcoded tube",
          "model":      "tube",
          "criteria":   {
            "label":{
              "position":"barcode",
              "type":    "ean13-barcode",
              "value":   "tube1_BC"
            }
          }
        }
      },
      "response":   {
        "search":{
          "actions":{
            "read": "http://localhost:9292/46ff7c00-68ac-0130-7ac8-282066132de2",
            "first":"http://localhost:9292/46ff7c00-68ac-0130-7ac8-282066132de2/page=1",
            "last": "http://localhost:9292/46ff7c00-68ac-0130-7ac8-282066132de2/page=-1"
          },
          "uuid":   "46ff7c00-68ac-0130-7ac8-282066132de2"
        }
      }
    },
    {
      "description":"Get the search results (tubes 1)",
      "method":     "get",
      "url":        "/46ff7c00-68ac-0130-7ac8-282066132de2/page=1",
      "request":    null,
      "response":   {
        "actions":{
          "read": "http://localhost:9292/tubes/page=1",
          "first":"http://localhost:9292/tubes/page=1",
          "last": "http://localhost:9292/tubes/page=-1"
        },
        "size":   1,
        "tubes":  [
          {
            "actions":   {
              "read":  "http://localhost:9292/tube1_UUID",
              "create":"http://localhost:9292/tube1_UUID",
              "update":"http://localhost:9292/tube1_UUID",
              "delete":"http://localhost:9292/tube1_UUID"
            },
            "uuid":      "tube1_UUID",
            "type":      null,
            "max_volume":null,
            "aliquots":  [
              {
                "sample":  {
                  "actions":{
                    "read":  "http://localhost:9292/472fc450-68ac-0130-7ac8-282066132de2",
                    "create":"http://localhost:9292/472fc450-68ac-0130-7ac8-282066132de2",
                    "update":"http://localhost:9292/472fc450-68ac-0130-7ac8-282066132de2",
                    "delete":"http://localhost:9292/472fc450-68ac-0130-7ac8-282066132de2"
                  },
                  "uuid":   "472fc450-68ac-0130-7ac8-282066132de2",
                  "name":   "sample_0"
                },
                "quantity":1000,
                "type":    "NA+P",
                "unit":    "mole"
              }
            ],
            "labels":    {
              "actions":{
                "read":  "http://localhost:9292/3bcf91e0-68ac-0130-9163-282066132de2",
                "create":"http://localhost:9292/3bcf91e0-68ac-0130-9163-282066132de2",
                "update":"http://localhost:9292/3bcf91e0-68ac-0130-9163-282066132de2",
                "delete":"http://localhost:9292/3bcf91e0-68ac-0130-9163-282066132de2"
              },
              "uuid":   "3bcf91e0-68ac-0130-9163-282066132de2",
              "barcode":{
                "value":"tube1_BC",
                "type": "ean13-barcode"
              }
            }
          }
        ]
      }
    },
    {
      "description":"Find the tubes by barcodes for tube 2...",
      "method":"post",
      "url":"/searches",
      "request":{
        "search":{
          "user":"username",
          "description":"search for barcoded tube",
          "model":"tube",
          "criteria":{
            "label":{
              "position":"barcode",
              "type":"ean13-barcode",
              "value":"tube2_BC"
            }
          }
        }
      },
      "response":{
        "search":{
          "actions":{
            "read":"http://localhost:9292/46ff7c00-0000-0000-7ac8-282066132de2",
            "first":"http://localhost:9292/46ff7c00-0000-0000-7ac8-282066132de2/page=1",
            "last":"http://localhost:9292/46ff7c00-0000-0000-7ac8-282066132de2/page=-1"
          },
          "uuid":"46ff7c00-0000-0000-7ac8-282066132de2"
        }
      }
    },
    {
      "description":"Get the search results (tubes 2)",
      "method":"get",
      "url":"/46ff7c00-0000-0000-7ac8-282066132de2/page=1",
      "request":null,
      "response":{
        "actions":{
          "read":"http://localhost:9292/tubes/page=1",
          "first":"http://localhost:9292/tubes/page=1",
          "last":"http://localhost:9292/tubes/page=-1"
        },
        "size":1,
        "tubes":[
          {
            "actions":{
              "read":"http://localhost:9292/tube2_UUID",
              "create":"http://localhost:9292/tube2_UUID",
              "update":"http://localhost:9292/tube2_UUID",
              "delete":"http://localhost:9292/tube2_UUID"
            },
            "uuid":"tube2_UUID",
            "type":null,
            "max_volume":null,
            "aliquots":[
              {
                "sample":{
                  "actions":{
                    "read":"http://localhost:9292/472fc450-0000-0130-7ac8-282066132de2",
                    "create":"http://localhost:9292/472fc450-0000-0130-7ac8-282066132de2",
                    "update":"http://localhost:9292/472fc450-0000-0130-7ac8-282066132de2",
                    "delete":"http://localhost:9292/472fc450-0000-0130-7ac8-282066132de2"
                  },
                  "uuid":"472fc450-0000-0130-7ac8-282066132de2",
                  "name":"sample_0"
                },
                "quantity":1000,
                "type":"NA+P",
                "unit":"mole"
              }
            ],
            "labels":{
              "actions":{
                "read":"http://localhost:9292/3bcf91e0-0000-0130-9163-282066132de2",
                "create":"http://localhost:9292/3bcf91e0-0000-0130-9163-282066132de2",
                "update":"http://localhost:9292/3bcf91e0-0000-0130-9163-282066132de2",
                "delete":"http://localhost:9292/3bcf91e0-0000-0130-9163-282066132de2"
              },
              "uuid":"3bcf91e0-0000-0130-9163-282066132de2",
              "barcode":{
                "value":"tube2_BC",
                "type":"ean13-barcode"
              }
            }
          }
        ]
      }
    },
    {
      "description":"Find the order by tube uuid and role for tube 1",
      "method":     "post",
      "url":        "/searches",
      "request":    {
        "search":{
          "user":       "username",
          "description":"search for order",
          "model":      "order",
          "criteria":   {
            "item":{
              "uuid":"tube1_UUID"
            }
          }
        }
      },
      "response":   {
        "search":{
          "actions":{
            "read": "http://localhost:9292/473203b0-68ac-0130-7ac8-282066132de2",
            "first":"http://localhost:9292/473203b0-68ac-0130-7ac8-282066132de2/page=1",
            "last": "http://localhost:9292/473203b0-68ac-0130-7ac8-282066132de2/page=-1"
          },
          "uuid":   "473203b0-68ac-0130-7ac8-282066132de2"
        }
      }
    },
    {
      "description":"Get the search results (order 1)",
      "method":     "get",
      "url":        "/473203b0-68ac-0130-7ac8-282066132de2/page=1",
      "request":    null,
      "response":   {
        "actions":{
          "read": "http://localhost:9292/orders/page=1",
          "first":"http://localhost:9292/orders/page=1",
          "last": "http://localhost:9292/orders/page=-1"
        },
        "size":   1,
        "orders": [
          {
            "actions":   {
              "read":  "http://localhost:9292/order1_UUID",
              "create":"http://localhost:9292/order1_UUID",
              "update":"http://localhost:9292/order1_UUID",
              "delete":"http://localhost:9292/order1_UUID"
            },
            "uuid":      "order1_UUID",
            "pipeline":  "DNA+RNA manual extraction",
            "status":    "draft",
            "parameters":{},
            "state":     {},
            "cost_code": "cost code",
            "creator":   {
              "actions":{
                "read":  "http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "create":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "update":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "delete":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2"
              },
              "uuid":   "3bce77b0-68ac-0130-9163-282066132de2"
            },
            "study":     {
              "actions":{
                "read":  "http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "create":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "update":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "delete":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2"
              },
              "uuid":   "3bce8620-68ac-0130-9163-282066132de2"
            },
            "items":     {
              "tube_to_be_extracted":[
                {
                  "uuid":  "tube1_UUID",
                  "status":"done",
                  "batch": null
                },
                {
                  "uuid":  "tube2_UUID",
                  "status":"done",
                  "batch": null
                }
              ]
            }
          }
        ]
      }
    },

    {
      "description":"Find the order by tube uuid and role for tube 2",
      "method":"post",
      "url":"/searches",
      "request":{
        "search":{
          "user":"username",
          "description":"search for order",
          "model":"order",
          "criteria":{
            "item":{
              "uuid":"tube2_UUID"
            }
          }
        }
      },
      "response":{
        "search":{
          "actions":{
            "read":"http://localhost:9292/473203b0-0000-0000-7ac8-282066132de2",
            "first":"http://localhost:9292/473203b0-0000-0000-7ac8-282066132de2/page=1",
            "last":"http://localhost:9292/473203b0-0000-0000-7ac8-282066132de2/page=-1"
          },
          "uuid":"473203b0-0000-0000-7ac8-282066132de2"
        }
      }
    },
    {
      "description":"Get the search results (order 2)",
      "method":"get",
      "url":"/473203b0-0000-0000-7ac8-282066132de2/page=1",
      "request":null,
      "response":{
        "actions":{
          "read":"http://localhost:9292/orders/page=1",
          "first":"http://localhost:9292/orders/page=1",
          "last":"http://localhost:9292/orders/page=-1"
        },
        "size":1,
        "orders":[
          {
            "actions":   {
              "read":  "http://localhost:9292/order1_UUID",
              "create":"http://localhost:9292/order1_UUID",
              "update":"http://localhost:9292/order1_UUID",
              "delete":"http://localhost:9292/order1_UUID"
            },
            "uuid":      "order1_UUID",
            "pipeline":  "DNA+RNA manual extraction",
            "status":    "draft",
            "parameters":{},
            "state":     {},
            "cost_code": "cost code",
            "creator":   {
              "actions":{
                "read":  "http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "create":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "update":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "delete":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2"
              },
              "uuid":   "3bce77b0-68ac-0130-9163-282066132de2"
            },
            "study":     {
              "actions":{
                "read":  "http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "create":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "update":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "delete":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2"
              },
              "uuid":   "3bce8620-68ac-0130-9163-282066132de2"
            },
            "items":     {
              "tube_to_be_extracted":[
                {
                  "uuid":  "tube1_UUID",
                  "status":"done",
                  "batch": null
                },
                {
                  "uuid":  "tube2_UUID",
                  "status":"done",
                  "batch": null
                }
              ]
            }
          }
        ]
      }
    },
    {
      "description":"Create a new batch",
      "method":     "post",
      "url":        "/batches",
      "request":    {
        "batch":{
          "user":"username"
        }
      },
      "response":   {
        "batch":{
          "actions":{
            "read":  "http://localhost:9292/batch_UUID",
            "create":"http://localhost:9292/batch_UUID",
            "update":"http://localhost:9292/batch_UUID",
            "delete":"http://localhost:9292/batch_UUID"
          },
          "uuid":   "batch_UUID",
          "process":null
        }
      }
    },

    {
      "description":"update order",
      "method":     "put",
      "url":        "/order1_UUID",
      "request":    {
        "user":"username",
        "items":{
          "tube_to_be_extracted":{
            "tube1_UUID":{
              "batch_uuid":"batch_UUID"
            },
            "tube2_UUID":{
              "batch_uuid":"batch_UUID"
            }
          }

        }
      },
      "response":   {
        "order": {
          "user":"username"
        }
      }
    }
  ]
}
